<!doctype html>
<html lang="zh-tw">
  <head>
  <meta charset="utf-8">
<title>[Express&#43;Vue 搭建電商網站] 11 認識 vuex - 薛丁格的工程師</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog_tech/favicon/apple-touch-icon.png?v=1">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog_tech/favicon/favicon-32x32.png?v=1">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog_tech/favicon/favicon-16x16.png?v=1">
  <link rel="manifest" href="/blog_tech/favicon/site.webmanifest?v=1">
  
    <link rel="mask-icon" href="/blog_tech/favicon/safari-pinned-tab.svg?v=1" color="#ffffff">
    <link rel="shortcut icon" href="/blog_tech/favicon/favicon.ico?v=1">
    <meta name="msapplication-config" content="/blog_tech/favicon/browserconfig.xml?v=1">
  
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

<meta name="generator" content="Hugo 0.83.1" /><meta property="og:site_name" content="薛丁格的工程師">
  <meta property="og:title" content="[Express&#43;Vue 搭建電商網站] 11 認識 vuex">
  <meta property="og:description" content="使用 Express &#43; Vue 搭建一個電商網站 - 認識 vuex">
  <meta property="description" content="使用 Express &#43; Vue 搭建一個電商網站 - 認識 vuex">
  <meta property="og:url" content="https://ray247k.github.io/blog_tech/blog/202009-express-vue-build-ecommerce-11-install_vuex/">
  <meta property="og:type" content="article">
  
    <meta property="og:image" content="https://ray247k.github.io/blog_tech/img/main/logo.jpg">
  
  <link rel="stylesheet" href="/blog_tech/css/bundle.min.6ad9eb85bff384c75937a02036b01425a2ca63f19a96535b8ba5b181db62a4b3.css" integrity="sha256-atnrhb/zhMdZN6AgNrAUJaLKY/GallNbi6WxgdtipLM="><link rel="stylesheet" href="/blog_tech/css/add-on.css">
</head>

  <body>
    

<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/blog_tech/" class="nav">
        
          Blog
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu menu">
      
        
          
          <a href="/blog_tech/blog_tech/" class="nav link"><i class='fa fa-home'></i> home</a>
        
      
        
          
          <a href="/blog_tech/blog_tech/about/" class="nav link"><i class='far fa-id-card'></i> about</a>
        
      
        
          
          <a href="/blog_tech/blog_tech/tags/" class="nav link"><i class='fas fa-tag'></i> tag</a>
        
      
        
          
          <a href="/blog_tech/blog_tech/categories/" class="nav link"><i class='fas fa-sitemap'></i> category</a>
        
      
      
      <a href="#search-input" class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
    </menu>
    <a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
    
    
    <a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  <menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu"></div></menu>
  
  
</header>

    <div id="wrapper">
      <section id="site-intro" >
  <a href="/blog_tech/"><img src="https://ray247k.github.io/blog_tech/img/main/logo.jpg" class="bevel" width="100" alt="一隻箱子裡的貓，看著電腦螢幕" /></a>
  <header>
    <h1>Schrödinger's Programmer</h1>
  </header>
  <main>
    <p>奔跑吧工程師，趁年輕跑得越遠越好</p>
  </main>
  
    <footer>
      <ul class="socnet-icons">
        

        <li><a href="//github.com/ray247k" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>
<li><a href="//gitlab.com/ray247k" target="_blank" rel="noopener" title="GitLab" class="fab fa-gitlab"></a></li>






































<li><a href="mailto:ray247k@gmail.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
    </footer>
  
</section>

      <main id="site-main">
        
  <article class="post">
    <header>
  <div class="title">
    
      <h2><a href="/blog_tech/blog/202009-express-vue-build-ecommerce-11-install_vuex/">[Express&#43;Vue 搭建電商網站] 11 認識 vuex</a></h2>
    
    
      <p>使用 Express &#43; Vue 搭建一個電商網站 - 認識 vuex</p>
    
  </div>
  <div class="meta">
    <time datetime="2020-09-12 00:00:00 &#43;0000 UTC">2020/09/12</time>
    <p>Ray</p>
    
  </div>
</header>

    <div id="socnet-share">
      





    </div>
    <div class="content">
      
      <p><a href="https://vuex.vuejs.org/zh/">vuex</a> 來協助我們集中管理組件狀態，就不用到處維護狀態<br>
使得組件只需要專注於渲染頁面，而前端狀態都保留在 vuex 中建立的狀態庫中<br>
所謂狀態庫，其實也就是一個 Javascript 物件</p>
<h1 id="安裝-vuex">安裝 vuex</h1>
<p>可以使用指令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm install vuex --save
</code></pre></div><p>或是依然使用 <code>vue ui</code> 來安裝<br>
<img src="/img/blog/2020/09/express-vue-build-ecommerce-11-install_vuex/install-vuex.png" alt="install-vuex"></p>
<p>如果是使用 <code>vue ui</code> 安裝，會發現專案下多了一個檔案：<code>/src/store/index.js</code>，先用以下內容取代原本的檔案</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vue" data-lang="vue"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Vue</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;vue&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Vuex</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;vuex&#39;</span>;

<span style="color:#a6e22e">Vue</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">Vuex</span>);

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Vuex</span>.<span style="color:#a6e22e">Store</span>({
  <span style="color:#a6e22e">strict</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
  <span style="color:#a6e22e">state</span><span style="color:#f92672">:</span> {
    <span style="color:#75715e">// bought items
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">cart</span><span style="color:#f92672">:</span> [],
    <span style="color:#75715e">// ajax loader
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">showLoader</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
    <span style="color:#75715e">// selected product
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">product</span><span style="color:#f92672">:</span> {},
    <span style="color:#75715e">// all products
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">products</span><span style="color:#f92672">:</span> [
      {
        <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;產品 1&#39;</span>,
      }
    ],
    <span style="color:#75715e">// all manufacturers
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">manufacturers</span><span style="color:#f92672">:</span> [],
  }
})
</code></pre></div><p>上面我們做了一些事情</p>
<ul>
<li>導入了 <code>Vue</code> 和 <code>Vuex</code></li>
<li>調用 <code>Vue.use</code> 方法宣告使用 <code>Vuex</code>，聽起來和 <code>vue-router</code> 的時候一樣</li>
<li>最後導出 <code>Vuex.Store</code> 物件，並傳入 <code>strict</code> 和 <code>state</code> 參數<br>
<code>strict</code> 宣告我們必須使用 Vuex 的 Mutation 函數來改變 <code>state</code>，否則會報錯（這部分會在之後的章節說明）<br>
而 <code>state</code> 參數儲存全域的狀態，比如在這邊定義了 <code>cart</code>、<code>showLoader</code> 等屬性<br>
都是後面我們操作會使用到的資料</li>
</ul>
<h1 id="整合-vuex-和-vue">整合 Vuex 和 Vue</h1>
<p>當我們建立了 <code>Vuex</code> 的 <code>store</code> 物件後就可以使用它了，打開 <code>src/main.js</code><br>
在開頭導入之前建立的 <code>store</code>，並且將 <code>store</code> 添加到 Vue 初始化的參數列表裡</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vue" data-lang="vue"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Vue</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;vue&#39;</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">App</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./App.vue&#39;</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">router</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./router&#39;</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">store</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store&#39;</span>

<span style="color:#a6e22e">Vue</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">productionTip</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>

<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Vue</span>({
  <span style="color:#a6e22e">router</span>,
  <span style="color:#a6e22e">store</span>,
  <span style="color:#a6e22e">render</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">h</span> =&gt; <span style="color:#a6e22e">h</span>(<span style="color:#a6e22e">App</span>)
}).<span style="color:#a6e22e">$mount</span>(<span style="color:#e6db74">&#39;#app&#39;</span>)
</code></pre></div><p>如果你是使用 <code>Vue ui</code> 安裝，打開檔案可以見到程式已經幫我們完成了以上的內容<br>
當我們將 <code>store</code> 導入到了 Vue 中進行初始化後，Vue 會將 <code>store</code> 裡面的 <code>state</code> 注入到所有的組件中<br>
這樣所有的 Vue 組件就共享了一個全域的 <code>state</code></p>
<p>而所有的狀態變化都是針對這個 javascript 物件進行操作，然後觸發組件的重新渲染<br>
同時也避免了組件嵌套層級過多時，組件之間傳遞屬性的複雜性，便於大型程式與團隊合作</p>
<h1 id="查看結果">查看結果</h1>
<p>在整合好 Vuex 和 Vue 之後，馬上來看看 Vuex 帶來的變化。打開 <code>src/pages/admin/Products.vue</code> 修改成以下內容</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vue" data-lang="vue">&lt;<span style="color:#f92672">template</span>&gt;
  &lt;<span style="color:#f92672">div</span>&gt;
    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>&gt;
      &lt;<span style="color:#f92672">h1</span>&gt;<span style="color:#a6e22e">This</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">Admin</span>&lt;/<span style="color:#f92672">h1</span>&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;body&#34;</span>&gt;{{ <span style="color:#a6e22e">product</span>.<span style="color:#a6e22e">name</span> }}&lt;/<span style="color:#f92672">div</span>&gt;
  &lt;/<span style="color:#f92672">div</span>&gt;
&lt;/<span style="color:#f92672">template</span>&gt;

&lt;<span style="color:#f92672">script</span>&gt;
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> {
  <span style="color:#a6e22e">computed</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">product</span>() {
      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">$store</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">products</span>[<span style="color:#ae81ff">0</span>];
    }
  }
};
&lt;/<span style="color:#f92672">script</span>&gt;
</code></pre></div><p>可以在 <code>&lt;script&gt;</code> 中看到一個沒見過的東西 <code>computed</code>，先來了解一下這是什麼</p>
<h2 id="computed">Computed</h2>
<p>如果在前端模板內加入太多的邏輯運算，不但可讀性差也難以維護，這問題在後端套版時常常發生，很難一眼看出它到底要渲染什麼<br>
而 <code>計算屬性 (computed)</code> 有點類似於 method，但 method 需要括號來觸發<br>
而且 method 不管相依的資料有沒有改變，都會重新計算。computed 則是在相依的資料有改變時才做計算並渲染<br>
所以需要每次更新的行為用 method，在意效能的話使用 computed</p>
<p>講完了 <code>computed</code> 屬性，回頭來看剛剛的改動，我們在 <code>computed</code> 定義了一個 <code>product</code> 屬性<br>
會去 Vuex 也就是 <code>store</code> 中的 <code>state</code> 中 <code>products</code> 的第一個元素<br>
然後在頁面上使用剛剛取到的內容中的 <code>name</code> 屬性渲染</p>
<p>於是我們知道可以使用 <code>this.$store.state</code> 來取得 Vuex store 中保存的 <code>state</code></p>

      
      
<iframe class="LikeCoin" height="235" src="https://button.like.co/in/embed/ray247k/button?referrer=https%3a%2f%2fray247k.github.io%2fblog_tech%2fblog%2f202009-express-vue-build-ecommerce-11-install_vuex%2f" width="100%" frameborder=0></iframe>

    </div>
    <footer>
      <div class="stats">
  
    <ul class="categories">
      
        
          <li><a class="article-terms-link" href="/blog_tech/categories/node.js/">node.js</a></li>
        
      
    </ul>
  
  
    <ul class="tags">
      
        
          <li><a class="article-terms-link" href="/blog_tech/tags/vue/">vue</a></li>
        
          <li><a class="article-terms-link" href="/blog_tech/tags/node.js/">node.js</a></li>
        
          <li><a class="article-terms-link" href="/blog_tech/tags/vuex/">vuex</a></li>
        
      
    </ul>
  
</div>

    </footer>
  </article>
  
    

  
  <div class="pagination">
    
      <a href="/blog_tech/blog/202009-express-vue-build-ecommerce-12-vuex-mutation/" class="button left"><span>[Express&#43;Vue 搭建電商網站] 12 在 Vuex 使用 Mutation 管理狀態</span></a>
    
    
      <a href="/blog_tech/blog/202009-express-vue-build-ecommerce-10-new-product-page/" class="button right"><span>[Express&#43;Vue 搭建電商網站] 10 用 vue 建立一個表單</span></a>
    
  </div>

      </main>
      <section id="site-sidebar">
  
    <section id="recent-posts">
      <header>
        <h1>最新文章</h1>
      </header>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202104-use-ssh-key-login-remote-server/">設定 ssh 金鑰登入遠端主機</a></h2>
          <time class="published" datetime="2021-04-25 00:00:00 &#43;0000 UTC">2021/04/25</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202103-enable-docker-service-in-remote-server/">雲端主機啟動 Docker 服務</a></h2>
          <time class="published" datetime="2021-03-13 00:00:00 &#43;0000 UTC">2021/03/13</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202103-build-postgresql-database-useing-docker/">PostgreSQL 資料庫建置 - 使用 Docker</a></h2>
          <time class="published" datetime="2021-03-03 00:00:00 &#43;0000 UTC">2021/03/03</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202102-reverse-proxy-in-docker-service/">反向代理 - 在 Docker 環境建置</a></h2>
          <time class="published" datetime="2021-02-27 00:00:00 &#43;0000 UTC">2021/02/27</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202102-laravel-environment-basic-settings/">Laravel 執行環境建置</a></h2>
          <time class="published" datetime="2021-02-25 00:00:00 &#43;0000 UTC">2021/02/25</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202102-ngrok-share-your-local-development-site/">Ngrok 讓 localhost 可以被外部連線</a></h2>
          <time class="published" datetime="2021-02-14 00:00:00 &#43;0000 UTC">2021/02/14</time>
        </header>
      </article>
      
      <article class="mini-post">
          
        <header>
          <h2><a href="/blog_tech/blog/202101-portainer-open-source-container-management-gui/">Portainer - 視覺化管理 Docker 的工具</a></h2>
          <time class="published" datetime="2021-01-16 00:00:00 &#43;0000 UTC">2021/01/16</time>
        </header>
      </article>
      
      
        <footer>
          <a href="/blog_tech/blog/" class="button">查看更多</a>
        </footer>
      
    </section>
  

  
    

      <section id="categories">
        <header>
          <h1><a href="/blog_tech/categories">category</a></h1>
        </header>
        <ul>
          
          
          <li>
              <a href="/blog_tech/categories/node.js/">node.js<span class="count">12</span></a>
          
          <li>
              <a href="/blog_tech/categories/devops/">devops<span class="count">9</span></a>
          
          <li>
              <a href="/blog_tech/categories/laravel/">laravel<span class="count">1</span></a>
          
          </li>
        </ul>
      </section>
    
  

  
</section>

      <footer id="site-footer">
    
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>

      <script src="/blog_tech/js/highlight.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script><script src="/blog_tech/js/bundle.min.ccb4e6bb4674f9a0e2b6ce56bb0cddea093526d4bc032314766519cdfec730b1.js" integrity="sha256-zLTmu0Z0&#43;aDits5Wuwzd6gk1JtS8AyMUdmUZzf7HMLE="></script>
    <script src="/blog_tech/js/add-on.js"></script>
    </div>
  </body>
</html>
